<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel del Usuario - Farmacia Paracetamol ğŸ’Š</title>
  <link rel="stylesheet" href="/stylesheets/styles.css">
</head>

<body class="user-body">
  <header class="user-header">
    <h1>Farmacia Paracetamol ğŸ’Š</h1>
    <nav class="user-nav">
      <button id="btn-carrito">ğŸ›’ Carrito</button>
      <button id="btn-filtros">ğŸ” Filtros</button>
      <form action="/logout" method="post" class="logout-form">
        <button type="submit" id="btn-logout">ğŸšª Cerrar sesiÃ³n</button>
      </form>
    </nav>
  </header>

  <main class="productos-container">
    <h2>Productos disponibles</h2>

    <!-- Buscador / Filtros -->
    <div class="filtros">
      <input type="text" id="buscar" placeholder="Buscar producto...">
      <select id="categoria">
        <option value="">Todas las categorÃ­as</option>
        <option value="analgÃ©sicos">AnalgÃ©sicos</option>
        <option value="antibiÃ³ticos">AntibiÃ³ticos</option>
        <option value="vitaminas">Vitaminas</option>
      </select>
    </div>

    <!-- Lista de productos -->
    <div id="lista-productos" class="lista-productos">
      <!-- Los productos se cargarÃ¡n dinÃ¡micamente desde /api/productos -->
    </div>
  </main>

  <footer>
    <p>Â© 2025 Farmacia Paracetamol - Todos los derechos reservados</p>
  </footer>

  <script>
    // ğŸ”¹ Cargar productos desde la API
    async function cargarProductos() {
      const res = await fetch('/api/productos');
      const data = await res.json();
      const contenedor = document.getElementById('lista-productos');
      contenedor.innerHTML = '';

      data.items.forEach(p => {
        const card = document.createElement('div');
        card.classList.add('producto-card');
        card.innerHTML = `
          <img src="${p.imagen || '/images/default-product.png'}" alt="${p.nombre}">
          <h3>${p.nombre}</h3>
          <p>$${p.precio}</p>
          <button onclick="agregarAlCarrito(${p.id}, '${p.nombre}', ${p.precio})">Agregar al carrito</button>
        `;
        contenedor.appendChild(card);
      });
    }

    // ğŸ”¹ SimulaciÃ³n de carrito
    let carrito = [];

    function agregarAlCarrito(id, nombre, precio) {
      const existente = carrito.find(p => p.id === id);
      if (existente) {
        existente.cantidad++;
      } else {
        carrito.push({ id, nombre, precio, cantidad: 1 });
      }
      alert(`ğŸ›’ ${nombre} agregado al carrito`);
    }

    // ğŸ”¹ Filtro de bÃºsqueda
    document.getElementById('buscar').addEventListener('input', e => {
      const texto = e.target.value.toLowerCase();
      document.querySelectorAll('.producto-card').forEach(card => {
        const nombre = card.querySelector('h3').textContent.toLowerCase();
        card.style.display = nombre.includes(texto) ? 'block' : 'none';
      });
    });

    // ğŸ”¹ Filtro por categorÃ­a (opcional)
    document.getElementById('categoria').addEventListener('change', e => {
      const categoria = e.target.value;
      // En el futuro podrÃ­as hacer fetch('/api/productos?categoria=...')
      console.log(`Filtrar por categorÃ­a: ${categoria}`);
    });

    // Cargar los productos al entrar
    cargarProductos();
  </script>
</body>
</html>
